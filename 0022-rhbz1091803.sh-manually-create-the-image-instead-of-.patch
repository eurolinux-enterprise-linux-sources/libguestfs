From 86f6ab0130f396365e123e27610c1adb49851f9c Mon Sep 17 00:00:00 2001
From: Pino Toscano <ptoscano@redhat.com>
Date: Mon, 5 May 2014 09:17:46 -0400
Subject: [PATCH 022/102] rhbz1091803.sh: manually create the image instead of
 using 'scratch'

'add-drive-scratch' is new in >= 1.26.
---
 tests/regressions/rhbz1091803.sh | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/tests/regressions/rhbz1091803.sh b/tests/regressions/rhbz1091803.sh
index e9be95d..d1d0ae1 100755
--- a/tests/regressions/rhbz1091803.sh
+++ b/tests/regressions/rhbz1091803.sh
@@ -28,8 +28,13 @@ if [ -n "$SKIP_TEST_RHBZ1091803_SH" ]; then
     exit 77
 fi
 
+rm -f rhbz1091803.img
+
+touch rhbz1091803.img
+truncate -s 100M rhbz1091803.img
+
 ../../fish/guestfish <<EOF
-scratch 100M
+add-drive rhbz1091803.img format:raw
 run
 mkfs ext2 /dev/sda
 mount /dev/sda /
@@ -37,3 +42,5 @@ mount /dev/sda /
 # Appliance has now crashed, so any subsequent command fails:
 ping-daemon
 EOF
+
+rm rhbz1091803.img
-- 
1.9.3

